package ideas

import org.junit.runner.RunWith
import org.scalatest.FunSuite
import org.scalatest.junit.JUnitRunner
import tradinganalyzers.TradingPositionAnalyzer
import tradinganalyzers.TradingOp._
import tradingideas.TradingIdea._
import tradingideas.{NegativeTrendCandles, PositiveTrendCandles, LongTrendCandles}
import tradingsystems.{YearProfit, Candle}
import org.joda.time.LocalDate
import tradinganalyzers.statistics.VolatileDaysStatisticalPrinter

@RunWith(classOf[JUnitRunner])
class Stocks1DayCandlesVolatileDays_Test extends FunSuite
{
    class SimpleTest(val ticker: String, override val targetProfit: Double = 19) extends VolatileDaysStatisticalPrinter

    test("sberbank 1 day candles percent stop, take profit")
    {
        new SimpleTest("SBER", 30)
        {
            override def isUsefulOutput(yearProfits: Vector[YearProfit]): Boolean = yearProfits.length == 4 &&
                yearProfits.forall(_.strictProfit(25))
            override def positiveCandle(c: Candle): Boolean = c.buyProfitPct > 0.25
            override def negativeCandle(c: Candle): Boolean = c.sellProfitPct > 0.25
        }.standardTest(stopMultiplierStep = 1)
    }

    test("sberbank concrete example")
    {
        new SimpleTest("SBER", 10)
        {
            val op1 = sell(3, 8)
            val op2 = buy(5, 7)
            val (op1CheckDays, op1PositionDays, op2CheckDays, op2PositionDays) = (2, 3, 2, 7)
            val op1Desc = op1CheckDays + " дня роста, " + op1PositionDays + " дня в " + op1.desc
            val op2Desc = op2CheckDays + " дня падения, " + op2PositionDays + " дня в " + op2.desc
            println(getStringStatistics(op1Desc + " и " + op2Desc,
                (new PositiveTrendCandles(2, 3).filterInterestingDays(data), op1),
                (new NegativeTrendCandles(2, 7).filterInterestingDays(data), op2)
            ))
        }
    }

//  SummedProfit
//  2 дня роста, 5 дня в op:sell p: 8,00 s: 3,00 и 2 дня падения, 7 дня в op:buy  p: 8,00 s: 2,00 | 2010|026|035|  47,16|-3,00| -9,83|  86,38|2011|023|036|  42,60|-4,93| -8,00|  92,47|2012|022|023|  48,11|-11,32| -7,21|  91,11|2013|008|010|  22,77|-15,22| -6,12| 102,09 |  | 1 | 002 | -0,29 | -3,00 | 2 | 006 | 10,65 | 0,00 | 3 | 006 | -4,98 | -9,83 | 4 | 005 | 0,28 | 0,00 | 5 | 009 | 12,88 | -4,00 | 6 | 004 | 5,46 | 0,00 | 7 | 007 | 16,89 | -4,00 | 8 | 005 | 0,00 | -8,00 | 9 | 004 | 6,12 | -3,00 | 10 | 005 | 4,55 | -3,00 | 11 | 004 | -8,61 | -8,61 | 12 | 004 | 4,20 | 0,00| | 1 | 003 | 3,07 | -1,23 | 2 | 007 | -2,62 | -8,00 | 3 | 004 | 12,79 | 0,00 | 4 | 004 | -2,79 | -2,79 | 5 | 004 | 1,64 | -3,31 | 6 | 005 | 3,45 | -7,00 | 7 | 003 | -1,86 | -1,86 | 8 | 006 | 1,96 | -4,00 | 9 | 004 | -2,24 | -2,24 | 10 | 008 | 11,00 | -5,00 | 11 | 006 | 2,10 | -5,00 | 12 | 005 | 16,11 | 0,00| | 1 | 003 | -4,11 | -4,11 | 2 | 004 | -1,53 | -7,21 | 3 | 005 | 2,83 | 0,00 | 4 | 001 | 0,80 | 0,00 | 5 | 004 | 10,57 | 0,00 | 6 | 005 | 12,74 | -2,00 | 7 | 006 | 1,02 | -5,02 | 8 | 003 | 1,04 | -0,68 | 9 | 005 | -0,02 | -1,82 | 10 | 003 | 0,25 | 0,00 | 11 | 004 | 16,48 | 0,00 | 12 | 002 | 8,04 | 0,00| | 1 | 003 | -6,12 | -6,12 | 2 | 004 | -3,09 | -3,09 | 3 | 005 | -3,04 | -6,02 | 4 | 003 | 16,19 | 0,00 | 5 | 003 | 18,83 | 0,00
//  MultipliedProfit
//  2 дня роста, 3 дня в op:sell p: 7,00 s: 4,00 и 2 дня падения, 7 дня в op:buy  p: 7,00 s: 2,00 | 2010|032|039|  71,63|-4,00| -9,35|  86,38|2011|027|035|  43,50|-6,33| -7,76|  92,47|2012|026|026|  51,14|0,00| -3,96|  91,11|2013|011|011|  20,03|-8,91| -8,02| 102,09 |  | 1 | 003 | 4,57 | -4,00 | 2 | 007 | 8,95 | -7,76 | 3 | 006 | -4,95 | -9,35 | 4 | 006 | 0,62 | 0,00 | 5 | 009 | 11,53 | -3,96 | 6 | 007 | -5,88 | -5,88 | 7 | 007 | 23,73 | -3,96 | 8 | 005 | -1,31 | -7,76 | 9 | 005 | 16,20 | -1,62 | 10 | 006 | 3,66 | -4,00 | 11 | 006 | 2,68 | -5,88 | 12 | 004 | -0,66 | -0,66| | 1 | 003 | 1,55 | -1,25 | 2 | 007 | -2,82 | -7,76 | 3 | 003 | 10,29 | 0,00 | 4 | 004 | -2,80 | -2,80 | 5 | 004 | 1,49 | -3,30 | 6 | 005 | 1,69 | -5,46 | 7 | 004 | -2,99 | -2,99 | 8 | 006 | -2,74 | -3,96 | 9 | 006 | 3,45 | 0,00 | 10 | 008 | 16,02 | -5,29 | 11 | 007 | 4,89 | -5,92 | 12 | 005 | 10,65 | 0,00| | 1 | 004 | 0,86 | 0,00 | 2 | 004 | 4,98 | -0,74 | 3 | 005 | -2,83 | -3,86 | 4 | 002 | 0,94 | 0,00 | 5 | 005 | 4,12 | -2,30 | 6 | 006 | 10,52 | -2,00 | 7 | 006 | 5,33 | -2,78 | 8 | 005 | 5,97 | -2,00 | 9 | 005 | -0,18 | -1,95 | 10 | 004 | -2,52 | -2,52 | 11 | 004 | 7,67 | -3,96 | 12 | 002 | 8,15 | 0,00| | 1 | 003 | -3,28 | -3,28 | 2 | 004 | 2,39 | 0,00 | 3 | 005 | -5,28 | -8,02 | 4 | 005 | 16,89 | 0,00 | 5 | 005 | 9,47 | -2,33
//  2 дня роста, 3 дня в op:sell p: 8,00 s: 3,00 и 2 дня падения, 7 дня в op:buy  p: 7,00 s: 2,00 | 2010|034|041|  75,51|-8,56|-10,66|  86,38|2011|026|035|  40,71|-6,33| -7,76|  92,47|2012|026|026|  49,82|0,00| -3,96|  91,11|2013|011|011|  20,03|-8,91| -8,02| 102,09 |  | 1 | 004 | -0,86 | -3,53 | 2 | 007 | 9,97 | -7,76 | 3 | 007 | -6,33 | -10,66 | 4 | 006 | -1,23 | -1,23 | 5 | 009 | 13,62 | -3,96 | 6 | 007 | -3,14 | -3,14 | 7 | 007 | 23,73 | -3,96 | 8 | 005 | -1,31 | -7,76 | 9 | 005 | 16,20 | -1,62 | 10 | 008 | 9,24 | -3,00 | 11 | 006 | 2,68 | -5,88 | 12 | 004 | -0,66 | -0,66| | 1 | 003 | 1,55 | -1,25 | 2 | 007 | -2,82 | -7,76 | 3 | 003 | 10,29 | 0,00 | 4 | 004 | -2,80 | -2,80 | 5 | 004 | 1,49 | -3,30 | 6 | 005 | 0,21 | -6,84 | 7 | 004 | -2,99 | -2,99 | 8 | 006 | -0,81 | -3,96 | 9 | 005 | 4,85 | 0,00 | 10 | 008 | 8,38 | -6,21 | 11 | 007 | 8,09 | -4,94 | 12 | 005 | 10,65 | 0,00| | 1 | 004 | 1,91 | 0,00 | 2 | 004 | 4,98 | -0,74 | 3 | 005 | -2,83 | -3,86 | 4 | 002 | 0,94 | 0,00 | 5 | 005 | 4,12 | -2,30 | 6 | 006 | 8,42 | -2,00 | 7 | 006 | 5,33 | -2,78 | 8 | 005 | 5,97 | -2,00 | 9 | 005 | -0,18 | -1,95 | 10 | 004 | -2,52 | -2,52 | 11 | 004 | 7,67 | -3,96 | 12 | 002 | 8,15 | 0,00| | 1 | 003 | -3,28 | -3,28 | 2 | 004 | 2,39 | 0,00 | 3 | 005 | -5,28 | -8,02 | 4 | 005 | 16,89 | 0,00 | 5 | 005 | 9,47 | -2,33
//  2 дня роста, 5 дня в op:sell p: 8,00 s: 3,00 и 2 дня падения, 7 дня в op:buy  p: 8,00 s: 2,00 | 2010|026|035|  52,60|-3,00| -9,48|  86,38|2011|023|036|  46,19|-5,00| -7,76|  92,47|2012|022|023|  56,83|-10,88| -7,04|  91,11|2013|008|010|  23,77|-14,31| -6,02| 102,09 |  | 1 | 002 | -0,37 | -3,00 | 2 | 006 | 10,49 | 0,00 | 3 | 006 | -5,09 | -9,48 | 4 | 005 | 0,10 | 0,00 | 5 | 009 | 12,59 | -3,96 | 6 | 004 | 5,13 | 0,00 | 7 | 007 | 17,25 | -3,96 | 8 | 005 | -0,38 | -7,76 | 9 | 004 | 5,94 | -3,00 | 10 | 005 | 4,34 | -3,00 | 11 | 004 | -8,34 | -8,34 | 12 | 004 | 4,17 | 0,00| | 1 | 003 | 3,00 | -1,25 | 2 | 007 | -2,82 | -7,76 | 3 | 004 | 12,92 | 0,00 | 4 | 004 | -2,80 | -2,80 | 5 | 004 | 1,49 | -3,30 | 6 | 005 | 3,08 | -6,84 | 7 | 003 | -1,87 | -1,87 | 8 | 006 | 1,51 | -3,96 | 9 | 004 | -2,41 | -2,41 | 10 | 008 | 10,42 | -5,33 | 11 | 006 | 1,60 | -4,94 | 12 | 005 | 16,63 | 0,00| | 1 | 003 | -4,13 | -4,13 | 2 | 004 | -1,76 | -7,04 | 3 | 005 | 2,71 | 0,00 | 4 | 001 | 0,80 | 0,00 | 5 | 004 | 10,54 | 0,00 | 6 | 005 | 12,80 | -2,00 | 7 | 006 | 0,65 | -4,93 | 8 | 003 | 1,03 | -0,68 | 9 | 005 | -0,18 | -1,95 | 10 | 003 | 0,21 | 0,00 | 11 | 004 | 17,25 | 0,00 | 12 | 002 | 8,15 | 0,00| | 1 | 003 | -6,02 | -6,02 | 2 | 004 | -3,10 | -3,10 | 3 | 005 | -3,10 | -5,90 | 4 | 003 | 16,94 | 0,00 | 5 | 003 | 19,94 | 0,00

    test("sberbank 1 day candles percent stop, take profit brute force") { new SimpleTest("SBER", 40).standardTest(stopMultiplierStep = 1) }

//  SummedProfit
//  2 дня роста, 7 дня в op:sell p: 6,00 s: 3,00 и 2 дня падения, 6 дня в op:buy  p: 5,00 s: 4,00 | 2010|029|018|  43,38|-7,27| -6,00| 169,12|2011|025|018|  60,67|0,00| -4,52| 192,56|2012|024|014|  30,68|-0,11|-11,00| 162,34|2013|011|006|  20,33|0,00| -5,08| 133,22 |  | 1 | 002 | -1,27 | -4,00 | 2 | 006 | 2,54 | -6,00 | 3 | 005 | -3,44 | -5,44 | 4 | 004 | 12,43 | 0,00 | 5 | 006 | 6,00 | -4,00 | 6 | 003 | 14,58 | 0,00 | 7 | 004 | 6,47 | 0,00 | 8 | 003 | -3,83 | -4,00 | 9 | 003 | 9,60 | 0,00 | 10 | 003 | 5,65 | 0,00 | 11 | 003 | -3,17 | -3,17 | 12 | 005 | -2,17 | -6,00| | 1 | 002 | 5,72 | 0,00 | 2 | 004 | 6,93 | 0,00 | 3 | 003 | -3,92 | -4,52 | 4 | 004 | 14,00 | -3,00 | 5 | 005 | 1,64 | -4,00 | 6 | 003 | 0,36 | 0,00 | 7 | 002 | 5,65 | -0,35 | 8 | 003 | 3,45 | -4,00 | 9 | 004 | -0,06 | -1,06 | 10 | 004 | 5,00 | -1,00 | 11 | 005 | 2,95 | 0,00 | 12 | 004 | 18,95 | 0,00| | 1 | 003 | 7,80 | -0,11 | 2 | 003 | 3,36 | 0,00 | 3 | 003 | 3,33 | 0,00 | 4 | 002 | -1,39 | -4,00 | 5 | 004 | 4,00 | 0,00 | 6 | 003 | 12,48 | 0,00 | 7 | 003 | 4,84 | 0,00 | 8 | 004 | 11,41 | 0,00 | 9 | 004 | -10,93 | -11,00 | 10 | 003 | 1,14 | 0,00 | 11 | 003 | 1,47 | 0,00 | 12 | 003 | -6,82 | -6,82| | 1 | 002 | 6,73 | 0,00 | 2 | 003 | -1,24 | -4,00 | 3 | 004 | 2,47 | 0,00 | 4 | 003 | -3,97 | -5,08 | 5 | 004 | 10,34 | -3,00 | 6 | 001 | 6,00 | 0,00
//  MultipliedProfit
//  2 дня роста, 6 дня в op:sell p: 8,00 s: 3,00 и 2 дня падения, 6 дня в op:buy  p: 4,00 s: 4,00 | 2010|026|020|  44,37|-4,00| -5,91| 169,12|2011|026|020|  48,70|0,00| -7,91| 192,56|2012|025|016|  31,13|-0,31|-10,60| 162,34|2013|012|007|  19,45|-4,14| -7,84| 133,22 |  | 1 | 002 | -1,38 | -4,00 | 2 | 006 | 12,02 | -0,47 | 3 | 004 | -0,49 | -1,36 | 4 | 004 | 17,89 | 0,00 | 5 | 005 | 1,45 | -3,00 | 6 | 003 | 15,52 | 0,00 | 7 | 004 | 1,91 | 0,00 | 8 | 003 | 4,30 | -4,00 | 9 | 003 | -2,36 | -2,36 | 10 | 004 | -3,21 | -4,37 | 11 | 003 | -3,18 | -3,18 | 12 | 005 | -2,28 | -5,91| | 1 | 002 | 5,88 | 0,00 | 2 | 004 | 6,01 | 0,00 | 3 | 004 | -7,91 | -7,91 | 4 | 005 | 5,14 | -3,00 | 5 | 005 | 3,79 | -4,00 | 6 | 003 | -0,31 | -0,31 | 7 | 002 | 3,90 | -0,35 | 8 | 004 | 0,03 | -5,44 | 9 | 004 | 6,96 | -1,11 | 10 | 004 | 5,68 | -2,15 | 11 | 005 | -6,35 | -6,35 | 12 | 004 | 20,20 | 0,00| | 1 | 004 | 9,88 | -0,31 | 2 | 003 | 2,86 | -1,11 | 3 | 004 | 2,46 | -1,36 | 4 | 002 | -0,16 | -4,00 | 5 | 005 | 1,45 | 0,00 | 6 | 003 | 12,04 | 0,00 | 7 | 003 | 4,02 | 0,00 | 8 | 004 | 10,28 | 0,00 | 9 | 004 | -10,54 | -10,60 | 10 | 003 | 0,28 | 0,00 | 11 | 003 | 2,53 | 0,00 | 12 | 003 | -5,43 | -5,43| | 1 | 003 | 5,71 | 0,00 | 2 | 003 | 1,11 | -4,00 | 3 | 005 | -2,68 | -2,68 | 4 | 003 | -4,15 | -7,84 | 5 | 004 | 14,12 | -3,00 | 6 | 001 | 4,98 | 0,00
//  2 дня роста, 7 дня в op:sell p: 6,00 s: 3,00 и 2 дня падения, 6 дня в op:buy  p: 5,00 s: 4,00 | 2010|029|018|  49,36|-7,51| -6,22| 169,12|2011|025|018|  77,07|0,00| -4,48| 192,56|2012|024|014|  33,27|-0,11|-10,60| 162,34|2013|011|006|  21,02|0,00| -5,04| 133,22 |  | 1 | 002 | -1,38 | -4,00 | 2 | 006 | 1,96 | -6,22 | 3 | 005 | -3,68 | -5,43 | 4 | 004 | 12,89 | 0,00 | 5 | 006 | 5,47 | -4,00 | 6 | 003 | 15,25 | 0,00 | 7 | 004 | 6,45 | 0,00 | 8 | 003 | -3,93 | -4,00 | 9 | 003 | 9,89 | 0,00 | 10 | 003 | 5,68 | 0,00 | 11 | 003 | -3,18 | -3,18 | 12 | 005 | -2,28 | -5,91| | 1 | 002 | 5,79 | 0,00 | 2 | 004 | 6,91 | 0,00 | 3 | 003 | -3,90 | -4,48 | 4 | 004 | 14,44 | -3,00 | 5 | 005 | 1,21 | -4,00 | 6 | 003 | 0,23 | 0,00 | 7 | 002 | 5,62 | -0,35 | 8 | 003 | 3,23 | -4,00 | 9 | 004 | -0,39 | -1,18 | 10 | 004 | 4,72 | -1,21 | 11 | 005 | 2,55 | 0,00 | 12 | 004 | 20,32 | 0,00| | 1 | 003 | 7,93 | -0,11 | 2 | 003 | 3,39 | 0,00 | 3 | 003 | 3,16 | 0,00 | 4 | 002 | -1,49 | -4,00 | 5 | 004 | 3,64 | 0,00 | 6 | 003 | 12,99 | 0,00 | 7 | 003 | 4,87 | 0,00 | 8 | 004 | 11,86 | 0,00 | 9 | 004 | -10,54 | -10,60 | 10 | 003 | 0,99 | 0,00 | 11 | 003 | 1,46 | 0,00 | 12 | 003 | -6,68 | -6,68| | 1 | 002 | 6,82 | 0,00 | 2 | 003 | -1,34 | -4,00 | 3 | 004 | 2,15 | 0,00 | 4 | 003 | -3,98 | -5,04 | 5 | 004 | 10,45 | -3,00 | 6 | 001 | 6,00 | 0,00

    test("gazprom 1 day candles percent stop, take profit") { new SimpleTest("GAZP", 30).standardTest(stopMultiplierStep = 1) }

//  SummedProfit
//  2 дня роста, 2 дня в op:sell p: 5,00 s: 2,00 и 5 дня падения, 7 дня в op:buy  p: 4,00 s: 5,00 | 2010|027|025|  20,99|-2,00| -6,52|5261,29|2011|027|023|  20,33|-7,84| -9,08|6802,57|2012|024|018|  20,76|-7,48| -7,48|5186,75|2013|009|003|  18,78|-2,38| -2,18|5296,89 |  | 1 | 003 | 3,40 | -2,00 | 2 | 004 | 14,88 | 0,00 | 3 | 007 | -6,52 | -6,52 | 4 | 005 | 6,10 | -2,14 | 5 | 002 | 2,00 | 0,00 | 6 | 002 | 3,00 | 0,00 | 7 | 007 | -2,67 | -5,46 | 8 | 004 | 2,65 | -1,43 | 9 | 002 | 3,37 | 0,00 | 10 | 006 | -5,07 | -5,07 | 11 | 004 | 1,76 | -0,48 | 12 | 006 | -1,91 | -4,00| | 1 | 004 | 2,83 | 0,00 | 2 | 002 | -1,00 | -5,00 | 3 | 004 | -6,62 | -6,62 | 4 | 003 | 4,58 | 0,00 | 5 | 003 | 3,00 | 0,00 | 6 | 006 | -1,09 | -1,58 | 7 | 003 | -0,26 | -1,26 | 8 | 003 | -0,19 | -0,19 | 9 | 007 | 0,92 | -9,08 | 10 | 003 | 0,35 | -0,17 | 11 | 007 | 7,35 | -5,00 | 12 | 005 | 10,47 | -0,53| | 1 | 007 | -7,48 | -7,48 | 2 | 003 | 6,68 | 0,00 | 3 | 004 | 2,83 | -2,00 | 4 | 002 | 7,48 | 0,00 | 5 | 006 | 8,93 | -1,89 | 6 | 003 | 0,52 | -2,00 | 7 | 002 | 2,34 | 0,00 | 8 | 003 | -2,58 | -2,94 | 9 | 002 | 1,65 | 0,00 | 10 | 001 | 0,96 | 0,00 | 11 | 004 | 4,35 | -0,29 | 12 | 005 | -4,93 | -5,95| | 1 | 002 | -0,20 | -0,20 | 3 | 003 | -1,25 | -2,18 | 4 | 003 | 9,11 | 0,00 | 5 | 002 | 4,47 | 0,00 | 6 | 002 | 6,64 | 0,00
//  MultipliedProfit
//  2 дня роста, 2 дня в op:sell p: 5,00 s: 2,00 и 5 дня падения, 7 дня в op:buy  p: 4,00 s: 5,00 | 2010|027|025|  21,69|-2,00| -6,40|5261,29|2011|027|023|  20,62|-8,03| -8,76|6802,57|2012|024|018|  21,84|-7,28| -7,28|5186,75|2013|009|003|  20,23|-2,37| -2,18|5296,89 |  | 1 | 003 | 3,34 | -2,00 | 2 | 004 | 15,68 | 0,00 | 3 | 007 | -6,40 | -6,40 | 4 | 005 | 6,08 | -2,15 | 5 | 002 | 1,92 | 0,00 | 6 | 002 | 2,90 | 0,00 | 7 | 007 | -2,78 | -5,38 | 8 | 004 | 2,64 | -1,43 | 9 | 002 | 3,40 | 0,00 | 10 | 006 | -4,99 | -4,99 | 11 | 004 | 1,71 | -0,52 | 12 | 006 | -1,96 | -3,96| | 1 | 004 | 2,86 | 0,00 | 2 | 002 | -1,20 | -5,00 | 3 | 004 | -6,46 | -6,46 | 4 | 003 | 4,64 | 0,00 | 5 | 003 | 3,02 | 0,00 | 6 | 006 | -1,13 | -1,61 | 7 | 003 | -0,28 | -1,26 | 8 | 003 | -0,22 | -0,22 | 9 | 007 | 0,59 | -8,76 | 10 | 003 | 0,31 | -0,21 | 11 | 007 | 7,11 | -5,00 | 12 | 005 | 10,71 | -0,53| | 1 | 007 | -7,28 | -7,28 | 2 | 003 | 6,77 | 0,00 | 3 | 004 | 2,76 | -2,00 | 4 | 002 | 7,62 | 0,00 | 5 | 006 | 9,04 | -1,91 | 6 | 003 | 0,48 | -2,00 | 7 | 002 | 2,35 | 0,00 | 8 | 003 | -2,57 | -2,92 | 9 | 002 | 1,61 | 0,00 | 10 | 001 | 0,96 | 0,00 | 11 | 004 | 4,36 | -0,29 | 12 | 005 | -4,86 | -5,82| | 1 | 002 | -0,20 | -0,20 | 3 | 003 | -1,27 | -2,18 | 4 | 003 | 9,38 | 0,00 | 5 | 002 | 4,52 | 0,00 | 6 | 002 | 6,72 | 0,00

    test("nornikel 1 day candles percent stop, take profit") { new SimpleTest("GMKN", 20).standardTest(stopMultiplierStep = 1) }

//    SummedProfit
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 3 дня падения, 6 дня в op:sell p: 6,00 s: 3,00 | 2010|019|010|  15,92|0,00| -8,00|2011|015|013|  18,20|-6,80| -4,87|2012|015|013|  17,44|-1,79| -7,00|2013|008|003|   9,01|0,00| -3,00 |  | 1 | 001 | 5,00 | 0,00 | 2 | 003 | 8,00 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,25 | -0,94 | 5 | 002 | -2,78 | -3,00 | 6 | 003 | -7,08 | -8,00 | 7 | 003 | -6,56 | -6,56 | 8 | 003 | 4,50 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 002 | -0,24 | -3,00 | 11 | 003 | -0,30 | -0,30 | 12 | 002 | 2,25 | 0,00| | 1 | 001 | 0,59 | 0,00 | 2 | 002 | -4,54 | -4,54 | 3 | 003 | -2,85 | -2,85 | 4 | 002 | 11,14 | 0,00 | 5 | 004 | 0,55 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 7,82 | 0,00 | 9 | 002 | 2,00 | 0,00 | 10 | 003 | -3,92 | -4,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 003 | -0,87 | -2,87 | 3 | 003 | 2,08 | -1,42 | 4 | 002 | 4,23 | 0,00 | 5 | 002 | 6,92 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,15 | -0,15 | 9 | 004 | -4,42 | -7,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 002 | 1,80 | 0,00 | 2 | 002 | 1,26 | 0,00 | 3 | 003 | 6,65 | 0,00 | 4 | 001 | -3,00 | -3,00 | 5 | 002 | 5,30 | -0,70 | 6 | 001 | -3,00 | -3,00
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 3,00 s: 3,00 | 2010|015|008|  19,29|0,00| -8,00|2011|013|008|  21,00|0,00| -4,00|2012|013|010|  18,08|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 004 | 8,00 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,81 | -0,94 | 5 | 001 | -3,00 | -3,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 7,01 | 0,00 | 5 | 003 | -4,00 | -4,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 2,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,58 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 4,00 s: 3,00 | 2010|014|008|  18,29|0,00| -8,00|2011|013|007|  27,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 003 | 6,00 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 3,81 | -0,94 | 5 | 001 | -3,00 | -3,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 8,01 | 0,00 | 5 | 002 | 0,00 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 3,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 5,00 s: 3,00 | 2010|014|008|  17,65|0,00| -8,00|2011|013|007|  30,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 003 | 7,00 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -3,00 | -3,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 9,01 | 0,00 | 5 | 002 | 1,00 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 4,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 6,00 s: 3,00 | 2010|014|007|  18,22|0,00| -8,00|2011|012|008|  24,00|0,00| -7,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -3,00 | -3,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 10,01 | 0,00 | 5 | 002 | -7,00 | -7,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 5,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 7,00 s: 3,00 | 2010|014|007|  18,22|0,00| -8,00|2011|012|007|  29,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -3,00 | -3,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 11,01 | 0,00 | 5 | 001 | -4,00 | -4,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 6,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 8,00 s: 3,00 | 2010|014|007|  18,22|0,00| -8,00|2011|011|007|  21,11|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -3,00 | -3,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 7,12 | 0,00 | 5 | 001 | -4,00 | -4,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 003 | 2,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 3,00 s: 4,00 | 2010|015|008|  17,29|0,00| -8,00|2011|013|008|  20,00|0,00| -5,00|2012|013|010|  18,08|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 004 | 7,00 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,81 | -0,94 | 5 | 001 | -4,00 | -4,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 7,01 | 0,00 | 5 | 003 | -5,00 | -5,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 2,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,58 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 4,00 s: 4,00 | 2010|014|008|  16,29|0,00| -8,00|2011|013|007|  27,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 003 | 5,00 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 3,81 | -0,94 | 5 | 001 | -4,00 | -4,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 8,01 | 0,00 | 5 | 002 | 0,00 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 3,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 5,00 s: 4,00 | 2010|014|008|  15,65|0,00| -8,00|2011|013|007|  30,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 003 | 6,00 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -4,00 | -4,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 9,01 | 0,00 | 5 | 002 | 1,00 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 4,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 6,00 s: 4,00 | 2010|014|007|  17,22|0,00| -8,00|2011|012|008|  23,00|0,00| -8,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -4,00 | -4,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 10,01 | 0,00 | 5 | 002 | -8,00 | -8,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 5,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 7,00 s: 4,00 | 2010|014|007|  17,22|0,00| -8,00|2011|012|007|  29,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -4,00 | -4,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 11,01 | 0,00 | 5 | 001 | -4,00 | -4,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 6,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 8,00 s: 4,00 | 2010|014|007|  17,22|0,00| -8,00|2011|011|007|  21,11|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -4,00 | -4,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 7,12 | 0,00 | 5 | 001 | -4,00 | -4,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 003 | 2,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 3,00 s: 5,00 | 2010|015|008|  17,21|0,00| -8,00|2011|014|007|  27,00|0,00| -4,00|2012|013|010|  18,08|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 004 | 7,92 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,81 | -0,94 | 5 | 001 | -5,00 | -5,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 7,01 | 0,00 | 5 | 003 | 2,00 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 2,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,58 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 4,00 s: 5,00 | 2010|014|008|  16,21|0,00| -8,00|2011|013|007|  27,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 003 | 5,92 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 3,81 | -0,94 | 5 | 001 | -5,00 | -5,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 8,01 | 0,00 | 5 | 002 | 0,00 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 3,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 5,00 s: 5,00 | 2010|014|008|  15,57|0,00| -8,00|2011|013|007|  30,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 003 | 6,92 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -5,00 | -5,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 9,01 | 0,00 | 5 | 002 | 1,00 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 4,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 6,00 s: 5,00 | 2010|014|007|  16,22|0,00| -8,00|2011|013|007|  29,80|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -5,00 | -5,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 10,01 | 0,00 | 5 | 002 | -1,20 | -1,20 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 5,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 7,00 s: 5,00 | 2010|014|007|  16,22|0,00| -8,00|2011|012|007|  29,00|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -5,00 | -5,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 11,01 | 0,00 | 5 | 001 | -4,00 | -4,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 6,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 4,00 и 5 дня падения, 6 дня в op:sell p: 8,00 s: 5,00 | 2010|014|007|  16,22|0,00| -8,00|2011|011|007|  21,11|0,00| -4,00|2012|013|010|  17,50|-1,79| -4,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 002 | 7,56 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,17 | -0,94 | 5 | 001 | -5,00 | -5,00 | 6 | 003 | -7,08 | -8,00 | 7 | 001 | -4,00 | -4,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 7,12 | 0,00 | 5 | 001 | -4,00 | -4,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,19 | -2,81 | 8 | 003 | 2,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,00 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -0,91 | -4,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 5,00 s: 5,00 и 5 дня падения, 6 дня в op:sell p: 3,00 s: 3,00 | 2010|015|008|  16,29|0,00|-10,00|2011|013|008|  18,01|0,00| -5,00|2012|013|010|  16,61|-2,26| -5,00|2013|006|001|   7,93|0,00| -0,70 |  | 1 | 001 | 5,00 | 0,00 | 2 | 004 | 8,00 | 0,00 | 3 | 002 | 6,68 | 0,00 | 4 | 003 | 2,81 | -0,94 | 5 | 001 | -3,00 | -3,00 | 6 | 003 | -9,08 | -10,00 | 7 | 001 | -5,00 | -5,00 | 8 | 002 | 0,19 | 0,00 | 9 | 002 | 4,21 | -0,79 | 10 | 001 | 3,29 | 0,00 | 11 | 002 | 2,52 | 0,00 | 12 | 001 | 0,68 | 0,00| | 1 | 001 | 0,59 | 0,00 | 3 | 001 | 3,15 | 0,00 | 4 | 002 | 7,01 | 0,00 | 5 | 003 | -5,00 | -5,00 | 6 | 002 | -0,77 | -0,77 | 7 | 002 | 2,19 | -2,81 | 8 | 004 | 1,75 | 0,00 | 9 | 001 | 5,00 | 0,00 | 10 | 002 | -0,92 | -1,87 | 11 | 002 | 10,00 | 0,00 | 12 | 001 | -5,00 | -5,00| | 1 | 002 | 0,64 | -2,26 | 2 | 002 | 2,13 | -2,87 | 3 | 002 | 1,58 | -1,42 | 4 | 002 | 1,24 | 0,00 | 5 | 001 | 5,00 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,62 | -0,62 | 9 | 002 | -1,91 | -5,00 | 10 | 002 | 2,63 | -2,37 | 11 | 002 | 3,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 001 | 1,07 | 0,00 | 2 | 002 | 0,91 | 0,00 | 3 | 003 | 6,65 | 0,00 | 5 | 001 | -0,70 | -0,70
//    3 дня роста, 7 дня в op:sell p: 6,00 s: 4,00 и 3 дня падения, 6 дня в op:sell p: 6,00 s: 4,00 | 2010|019|008|  15,77|0,00| -8,00|2011|015|012|  17,73|-8,89| -5,87|2012|015|012|  15,69|-3,02| -8,00|2013|008|003|  10,11|0,00| -4,00 |  | 1 | 001 | 6,00 | 0,00 | 2 | 002 | 7,10 | 0,00 | 3 | 002 | 3,71 | 0,00 | 4 | 003 | 2,25 | -0,94 | 5 | 002 | 4,69 | 0,00 | 6 | 003 | -7,08 | -8,00 | 7 | 003 | -7,56 | -7,56 | 8 | 003 | 4,50 | 0,00 | 9 | 002 | 5,21 | -0,79 | 10 | 001 | -4,00 | -4,00 | 11 | 003 | -1,30 | -1,30 | 12 | 002 | 2,25 | 0,00| | 1 | 001 | 0,59 | 0,00 | 2 | 002 | -5,54 | -5,54 | 3 | 003 | -3,93 | -3,93 | 4 | 002 | 11,14 | 0,00 | 5 | 003 | 3,55 | 0,00 | 6 | 002 | -0,78 | -0,78 | 7 | 002 | 2,11 | -2,81 | 8 | 004 | 8,82 | 0,00 | 9 | 002 | -1,30 | -1,30 | 10 | 003 | -4,92 | -5,87 | 11 | 002 | 12,00 | 0,00 | 12 | 001 | -4,00 | -4,00| | 1 | 002 | 1,11 | -1,79 | 2 | 002 | -2,71 | -2,87 | 3 | 003 | 2,08 | -1,42 | 4 | 002 | 4,23 | 0,00 | 5 | 002 | 7,92 | 0,00 | 6 | 002 | 0,05 | 0,00 | 7 | 003 | 2,73 | 0,00 | 8 | 002 | -0,15 | -0,15 | 9 | 004 | -5,42 | -8,00 | 10 | 002 | 1,73 | -2,37 | 11 | 002 | 4,75 | 0,00 | 12 | 001 | -0,61 | -0,61| | 1 | 002 | 1,80 | 0,00 | 2 | 002 | 1,26 | 0,00 | 3 | 003 | 6,65 | 0,00 | 4 | 001 | -4,00 | -4,00 | 5 | 002 | 5,30 | -0,70 | 6 | 001 | -0,91 | -0,91
//    MultipliedProfit

    test("lukoil 1 day candles percent stop, take profit") { new SimpleTest("LKOH", 15.5).standardTest(stopMultiplierStep = 1) }
    test("novatek 1 day candles percent stop, take profit") { new SimpleTest("NVTK", 25).standardTest(stopMultiplierStep = 1) }
    test("rosneft 1 day candles percent stop, take profit") { new SimpleTest("ROSN", 25).standardTest(stopMultiplierStep = 1) }
    test("rostelecom 1 day candles percent stop, take profit") { new SimpleTest("RTKM", 35).standardTest(stopMultiplierStep = 1) }

    test("print negative position days")
    {
        new SimpleTest("SBER")
        {
            val op1positions = new LongTrendCandles(2, 5, _.buyProfitPct > 0.15).filterInterestingDays(data)
            val op2Positions = new LongTrendCandles(2, 5, _.sellProfitPct > 0).filterInterestingDays(data)
            val statistics = new TradingPositionAnalyzer((op1positions, sell(5, 8)), (op2Positions, buy(5, 8))).getStatistics
            println(statistics.flatMap(yp =>
                List(yp.yearProfitPct.formatted("%7.2f"), yp.yearSlumpPct.formatted("%7.2f"), yp.worstMonthSlumpString)).mkString(" | "))
            for(yp <- statistics)
            {
                println(List(yp.year, yp.negativeDeals, yp.positiveDeals).mkString(" | "))
                for(mp <- yp.monthProfits)
                {
                    println((mp.month :: mp.balance.negativeStartDatePositions.toList.map(d => d.getDayOfMonth)).mkString(" | "))
                    println((mp.month :: mp.balance.positiveStartDatePositions.toList.map(d => d.getDayOfMonth)).mkString(" | "))
                }
            }
        }
    }
}
