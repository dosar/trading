package statistics

import org.junit.runner.RunWith
import org.scalatest.junit.JUnitRunner
import org.scalatest.FunSuite
import logic.TestUtils
import tradingideas._
import tradinganalyzers.statistics.DayStandardImporter._
import tradinganalyzers.TradingOp._
import tradingsystems.TradingData
import scala.Double
import tradinganalyzers.TradingOp
import scala.io.Source
import parsing.SimpleTrendWilliamsAdOutputParser
import tradinganalyzers.statistics.{StrategyIdeaData, YearProfitStatistics}

/**
 * @author alespuh
 * @since 05.08.13
 */
@RunWith(classOf[JUnitRunner])
class WilliamsAdSimpleTrendMerge_Test extends FunSuite with TestUtils
{
//    max / min <= 2
//    NVTK|w - t|Min Williams A/D |14|3|2||4 дня роста, 1 дня в op:buy  p:12,00 s: 5,00| | 2010|007|002|  21,90|0,00| -5,00|2011|010|007|  22,72|-0,40| -5,79|2012|012|005|  20,64|-0,61| -5,00|2013|008|006|  11,40|-3,89| -4,41 |  | 2 | 002 | 6,95 | 0,00 | 5 | 002 | 1,65 | -5,00 | 8 | 003 | 2,56 | -0,54 | 10 | 001 | 1,01 | 0,00 | 12 | 001 | 9,74 | 0,00| | 1 | 001 | -0,40 | -0,40 | 2 | 001 | 1,58 | 0,00 | 3 | 001 | 6,22 | 0,00 | 4 | 002 | -5,79 | -5,79 | 5 | 005 | 4,93 | -0,04 | 6 | 001 | -0,15 | -0,15 | 8 | 002 | 1,91 | -5,00 | 9 | 001 | 8,33 | 0,00 | 11 | 001 | 4,52 | 0,00 | 12 | 002 | 1,58 | -2,91| | 1 | 002 | -0,61 | -0,61 | 2 | 002 | 0,48 | 0,00 | 3 | 002 | 6,50 | 0,00 | 4 | 001 | 2,92 | 0,00 | 5 | 002 | 1,79 | -5,00 | 6 | 001 | 1,28 | 0,00 | 7 | 001 | 6,23 | 0,00 | 8 | 001 | 0,93 | 0,00 | 9 | 002 | 4,45 | 0,00 | 10 | 001 | 1,54 | 0,00 | 11 | 002 | -4,86 | -5,00| | 1 | 001 | 0,51 | 0,00 | 2 | 003 | -2,37 | -4,41 | 3 | 004 | 1,07 | -1,14 | 4 | 003 | 1,41 | -2,60 | 5 | 002 | 9,58 | 0,00 | 6 | 001 | 1,20 | 0,00
//    RTKM|w - t|Min Williams A/D |9, 10, 11, 12, 13, 14, 15, 16|1|1||2 дня роста, 1 дня в op:sell p:10,00 s: 3,00| | 2010|031|027|  23,50|-3,71| -4,08|2011|030|023|  24,95|-0,15| -6,00|2012|029|024|  26,05|-4,15| -3,33|2013|025|015|  13,86|-2,38| -2,83 |  | 1 | 002 | 0,37 | 0,00 | 2 | 009 | -0,57 | -4,08 | 3 | 003 | 2,30 | 0,00 | 4 | 011 | 7,33 | -0,33 | 5 | 007 | 13,45 | 0,00 | 7 | 004 | 0,88 | -0,39 | 8 | 005 | -0,70 | -0,70 | 9 | 004 | 1,65 | 0,00 | 10 | 004 | -2,24 | -2,42 | 11 | 004 | 0,70 | 0,00 | 12 | 005 | 0,32 | -0,41| | 1 | 001 | -0,15 | -0,15 | 2 | 011 | 7,95 | 0,00 | 3 | 002 | -1,10 | -1,10 | 4 | 005 | 8,25 | 0,00 | 5 | 004 | -5,41 | -6,00 | 6 | 003 | 6,66 | 0,00 | 7 | 004 | -5,37 | -5,37 | 8 | 005 | 7,45 | 0,00 | 9 | 007 | 6,12 | 0,00 | 10 | 002 | 4,24 | 0,00 | 11 | 003 | 1,94 | 0,00 | 12 | 006 | -5,62 | -5,62| | 1 | 005 | -3,33 | -3,33 | 2 | 006 | 1,98 | -0,82 | 3 | 003 | 0,60 | 0,00 | 4 | 008 | 2,67 | -1,45 | 5 | 008 | 9,70 | 0,00 | 6 | 003 | -0,57 | -1,11 | 7 | 003 | 5,04 | 0,00 | 8 | 001 | -1,55 | -1,55 | 9 | 001 | -1,63 | -1,63 | 10 | 007 | 2,41 | -0,27 | 11 | 007 | 11,98 | 0,00 | 12 | 001 | -1,24 | -1,24| | 2 | 013 | -1,47 | -1,47 | 3 | 005 | 2,56 | -0,91 | 4 | 011 | 9,82 | 0,00 | 5 | 008 | 2,96 | -2,83 | 6 | 003 | -0,01 | -0,76
//    RTKM|w - t|Min Williams A/D |19|1|1||2 дня роста, 1 дня в op:sell p: 8,00 s: 5,00| | 2010|024|017|  23,34|0,00| -2,96|2011|022|013|  21,44|-0,10| -8,01|2012|021|016|  20,24|-1,11| -1,55|2013|022|010|  16,69|-3,39| -2,49 |  | 2 | 007 | 3,52 | 0,00 | 3 | 001 | -0,34 | -0,34 | 4 | 011 | 7,33 | -0,33 | 5 | 007 | 14,74 | 0,00 | 7 | 003 | 1,27 | 0,00 | 8 | 003 | -0,14 | -0,14 | 9 | 001 | -1,04 | -1,04 | 10 | 004 | -2,78 | -2,96 | 11 | 002 | 1,21 | 0,00 | 12 | 002 | -0,43 | -0,43| | 2 | 010 | 5,63 | -0,10 | 4 | 002 | 5,74 | 0,00 | 5 | 002 | -1,17 | -1,17 | 6 | 003 | 6,66 | 0,00 | 7 | 002 | 0,63 | 0,00 | 8 | 005 | 12,45 | 0,00 | 9 | 002 | 0,28 | -1,49 | 10 | 002 | 4,24 | 0,00 | 11 | 001 | -5,00 | -5,00 | 12 | 006 | -8,01 | -8,01| | 1 | 004 | -0,33 | -0,33 | 2 | 003 | 0,28 | -0,54 | 3 | 001 | 0,13 | 0,00 | 4 | 007 | 2,92 | -1,20 | 5 | 007 | 13,07 | 0,00 | 6 | 001 | -0,71 | -0,71 | 7 | 001 | 0,80 | 0,00 | 8 | 001 | -1,55 | -1,55 | 10 | 006 | 2,54 | -0,13 | 11 | 005 | 4,33 | 0,00 | 12 | 001 | -1,24 | -1,24| | 2 | 011 | -2,49 | -2,49 | 3 | 005 | 2,56 | -0,91 | 4 | 009 | 9,26 | 0,00 | 5 | 004 | 5,80 | 0,00 | 6 | 003 | 1,56 | 0,00
//    RTKM|w - t|Min Williams A/D |19|1|1||3 дня роста, 1 дня в op:sell p:10,00 s: 5,00| | 2010|024|017|  25,34|0,00| -2,96|2011|022|013|  21,32|-0,10| -8,01|2012|021|016|  20,24|-1,11| -1,55|2013|022|010|  16,69|-3,39| -2,49 |  | 2 | 007 | 3,52 | 0,00 | 3 | 001 | -0,34 | -0,34 | 4 | 011 | 7,33 | -0,33 | 5 | 007 | 16,74 | 0,00 | 7 | 003 | 1,27 | 0,00 | 8 | 003 | -0,14 | -0,14 | 9 | 001 | -1,04 | -1,04 | 10 | 004 | -2,78 | -2,96 | 11 | 002 | 1,21 | 0,00 | 12 | 002 | -0,43 | -0,43| | 2 | 010 | 5,63 | -0,10 | 4 | 002 | 5,74 | 0,00 | 5 | 002 | -1,17 | -1,17 | 6 | 003 | 6,66 | 0,00 | 7 | 002 | 0,63 | 0,00 | 8 | 005 | 12,33 | 0,00 | 9 | 002 | 0,28 | -1,49 | 10 | 002 | 4,24 | 0,00 | 11 | 001 | -5,00 | -5,00 | 12 | 006 | -8,01 | -8,01| | 1 | 004 | -0,33 | -0,33 | 2 | 003 | 0,28 | -0,54 | 3 | 001 | 0,13 | 0,00 | 4 | 007 | 2,92 | -1,20 | 5 | 007 | 13,07 | 0,00 | 6 | 001 | -0,71 | -0,71 | 7 | 001 | 0,80 | 0,00 | 8 | 001 | -1,55 | -1,55 | 10 | 006 | 2,54 | -0,13 | 11 | 005 | 4,33 | 0,00 | 12 | 001 | -1,24 | -1,24| | 2 | 011 | -2,49 | -2,49 | 3 | 005 | 2,56 | -0,91 | 4 | 009 | 9,26 | 0,00 | 5 | 004 | 5,80 | 0,00 | 6 | 003 | 1,56 | 0,00
//    RTKM|w - t|Min Williams A/D | 7, 8|1|1||2 дня роста, 1 дня в op:sell p:10,00 s: 3,00| | 2010|035|030|  24,60|-3,71| -4,08|2011|033|025|  23,08|-3,15| -6,00|2012|032|026|  27,64|-3,80| -3,33|2013|026|016|  12,75|-4,24| -2,83 |  | 1 | 002 | 0,37 | 0,00 | 2 | 009 | -0,57 | -4,08 | 3 | 003 | 2,30 | 0,00 | 4 | 011 | 7,33 | -0,33 | 5 | 008 | 15,11 | 0,00 | 7 | 005 | -1,01 | -2,28 | 8 | 007 | 0,30 | 0,00 | 9 | 005 | 2,45 | 0,00 | 10 | 005 | -1,89 | -2,42 | 11 | 004 | 0,70 | 0,00 | 12 | 006 | -0,50 | -1,23| | 1 | 002 | -3,15 | -3,15 | 2 | 011 | 7,95 | 0,00 | 3 | 003 | 1,76 | 0,00 | 4 | 006 | 8,35 | 0,00 | 5 | 004 | -5,41 | -6,00 | 6 | 003 | 6,66 | 0,00 | 7 | 004 | -5,37 | -5,37 | 8 | 005 | 7,45 | 0,00 | 9 | 007 | 6,12 | 0,00 | 10 | 003 | 1,84 | 0,00 | 11 | 004 | 2,50 | 0,00 | 12 | 006 | -5,62 | -5,62| | 1 | 005 | -3,33 | -3,33 | 2 | 007 | 2,33 | -0,47 | 3 | 004 | 1,31 | 0,00 | 4 | 008 | 2,67 | -1,45 | 5 | 008 | 9,70 | 0,00 | 6 | 004 | 0,66 | -0,71 | 7 | 004 | 4,56 | -0,48 | 8 | 001 | -1,55 | -1,55 | 9 | 002 | -1,85 | -1,85 | 10 | 007 | 2,41 | -0,27 | 11 | 007 | 11,98 | 0,00 | 12 | 001 | -1,24 | -1,24| | 1 | 001 | -1,86 | -1,86 | 2 | 013 | -1,47 | -1,47 | 3 | 005 | 2,56 | -0,91 | 4 | 012 | 10,57 | 0,00 | 5 | 008 | 2,96 | -2,83 | 6 | 003 | -0,01 | -0,76
//    RTKM|w - t|Max Williams A/D | 3|4, 5|2||3 дня падения, 1 дня в op:sell p:12,00 s: 3,00| | 2010|022|019|  30,81|0,00| -8,02|2011|021|027|  36,26|-16,04|-15,00|2012|025|018|  22,00|-0,33|-12,00|2013|010|007|  16,30|0,00| -3,00 |  | 1 | 002 | 7,63 | 0,00 | 2 | 003 | 7,97 | 0,00 | 3 | 004 | 0,96 | -4,24 | 4 | 002 | 8,20 | 0,00 | 5 | 002 | 7,28 | 0,00 | 6 | 004 | 8,30 | 0,00 | 7 | 004 | 2,89 | -0,59 | 8 | 004 | -0,01 | -0,76 | 9 | 005 | -3,60 | -8,02 | 10 | 004 | -3,60 | -3,60 | 11 | 005 | -2,37 | -3,19 | 12 | 002 | -2,84 | -2,84| | 1 | 004 | -0,93 | -6,00 | 2 | 001 | 1,99 | 0,00 | 3 | 007 | -3,68 | -6,48 | 4 | 004 | 4,96 | -3,00 | 5 | 003 | 7,97 | -3,00 | 6 | 006 | -11,36 | -12,35 | 7 | 006 | -9,14 | -15,00 | 8 | 005 | 30,00 | 0,00 | 9 | 003 | 19,46 | 0,00 | 10 | 004 | -2,45 | -3,00 | 11 | 003 | 2,19 | 0,00 | 12 | 002 | -2,76 | -3,00| | 1 | 002 | 2,68 | -0,33 | 2 | 002 | 0,14 | 0,00 | 3 | 004 | 1,18 | -1,16 | 4 | 002 | 5,87 | 0,00 | 5 | 004 | 20,26 | 0,00 | 6 | 004 | -3,65 | -6,00 | 7 | 004 | 3,01 | -0,12 | 8 | 006 | -4,05 | -6,66 | 9 | 005 | -7,85 | -12,00 | 10 | 003 | 7,37 | 0,00 | 11 | 003 | 3,87 | 0,00 | 12 | 004 | -6,81 | -6,81| | 1 | 003 | 5,05 | 0,00 | 2 | 002 | -0,18 | -3,00 | 3 | 004 | 9,09 | 0,00 | 4 | 003 | 2,58 | 0,00 | 5 | 004 | 2,77 | -3,00 | 6 | 001 | -3,00 | -3,00
//    NVTK|w - t|Min Williams A/D |11|4|2||2, 3 дня роста, 1 дня в op:buy  p: 8,00 s: 3,00| | 2010|008|003|  23,52|0,00| -3,00|2011|012|013|  28,23|-6,00| -9,00|2012|012|008|  20,74|-1,05| -3,00|2013|007|006|  10,10|-1,51| -3,67 |  | 2 | 001 | 2,71 | 0,00 | 3 | 001 | 3,28 | 0,00 | 5 | 002 | 5,00 | -3,00 | 7 | 001 | 2,12 | 0,00 | 8 | 002 | 0,50 | -1,24 | 9 | 001 | 2,62 | 0,00 | 10 | 001 | 0,53 | 0,00 | 11 | 001 | -1,24 | -1,24 | 12 | 001 | 8,00 | 0,00| | 1 | 002 | -6,00 | -6,00 | 2 | 001 | 3,55 | 0,00 | 3 | 001 | 8,00 | 0,00 | 4 | 003 | -6,87 | -6,87 | 5 | 005 | 11,81 | -3,00 | 6 | 003 | -4,44 | -6,00 | 7 | 001 | 8,00 | 0,00 | 8 | 004 | -1,00 | -9,00 | 9 | 001 | 8,00 | 0,00 | 11 | 001 | 5,02 | 0,00 | 12 | 003 | 2,16 | -3,00| | 1 | 002 | -1,05 | -1,05 | 2 | 002 | 1,55 | 0,00 | 3 | 002 | 2,19 | 0,00 | 4 | 001 | 3,58 | 0,00 | 5 | 003 | 0,92 | -3,00 | 6 | 002 | 7,86 | 0,00 | 7 | 002 | 5,00 | 0,00 | 8 | 001 | 1,97 | 0,00 | 9 | 002 | -1,03 | -3,00 | 10 | 002 | -0,54 | -0,54 | 11 | 001 | 0,31 | 0,00| | 1 | 001 | 2,98 | 0,00 | 2 | 003 | 0,61 | -2,25 | 3 | 004 | -2,21 | -3,67 | 4 | 003 | 1,10 | -2,89 | 5 | 001 | 8,00 | 0,00 | 6 | 001 | -0,38 | -0,38
//    NVTK|w - t|Min Williams A/D | 8|5|2||3 дня роста, 1 дня в op:buy  p:11,00 s: 4,00| | 2010|011|003|  33,28|0,00| -4,00|2011|014|011|  32,78|-4,62| -9,81|2012|015|008|  24,42|-4,04| -6,09|2013|005|007|  10,06|-4,61| -5,86 |  | 2 | 001 | 5,96 | 0,00 | 3 | 003 | 7,36 | 0,00 | 4 | 001 | 5,50 | 0,00 | 5 | 002 | 4,21 | -4,00 | 6 | 001 | 2,62 | 0,00 | 8 | 002 | -0,00 | -1,90 | 9 | 001 | 3,10 | 0,00 | 10 | 001 | 1,26 | 0,00 | 11 | 002 | 3,27 | 0,00| | 1 | 002 | -1,51 | -4,00 | 2 | 001 | 5,06 | 0,00 | 3 | 001 | 5,65 | 0,00 | 4 | 003 | -9,81 | -9,81 | 5 | 004 | 7,05 | -4,00 | 6 | 002 | -5,12 | -5,12 | 7 | 001 | 8,58 | 0,00 | 8 | 004 | 4,99 | -4,00 | 9 | 001 | 11,00 | 0,00 | 11 | 003 | 4,13 | -1,74 | 12 | 003 | 2,78 | -4,00| | 1 | 002 | -0,50 | -0,50 | 2 | 002 | 1,88 | 0,00 | 3 | 002 | 0,15 | -2,76 | 4 | 001 | 0,53 | 0,00 | 5 | 004 | -6,09 | -6,09 | 6 | 003 | 9,12 | 0,00 | 7 | 003 | 10,75 | 0,00 | 9 | 002 | 2,76 | 0,00 | 10 | 002 | -1,71 | -1,71 | 11 | 002 | 7,54 | 0,00| | 1 | 001 | 3,46 | 0,00 | 2 | 002 | -2,20 | -2,20 | 3 | 004 | -0,00 | -3,29 | 4 | 003 | 1,81 | -5,86 | 5 | 001 | 11,00 | 0,00 | 6 | 001 | -4,00 | -4,00
//    RTKM|w - t|Min Williams A/D | 4, 5, 6|1|1||2 дня роста, 1 дня в op:sell p:12,00 s: 3,00| | 2010|046|037|  31,28|-2,31| -4,08|2011|046|036|  20,17|0,00| -7,88|2012|042|034|  35,93|-0,86| -3,71|2013|033|020|  15,18|-1,95| -3,91 |  | 1 | 005 | 1,77 | 0,00 | 2 | 009 | -0,57 | -4,08 | 3 | 005 | -0,64 | -2,93 | 4 | 011 | 7,33 | -0,33 | 5 | 009 | 21,85 | 0,00 | 6 | 004 | 1,88 | -0,28 | 7 | 006 | -0,15 | -1,89 | 8 | 009 | -1,26 | -1,64 | 9 | 005 | 2,45 | 0,00 | 10 | 006 | 0,27 | -2,42 | 11 | 007 | -1,62 | -3,00 | 12 | 007 | -0,05 | -0,78| | 1 | 004 | 1,76 | 0,00 | 2 | 011 | 7,95 | 0,00 | 3 | 005 | 1,01 | 0,00 | 4 | 009 | 9,76 | 0,00 | 5 | 006 | -1,99 | -6,00 | 6 | 004 | 6,25 | -0,41 | 7 | 006 | -1,67 | -1,67 | 8 | 007 | -7,88 | -7,88 | 9 | 010 | 10,47 | -0,55 | 10 | 004 | 2,78 | 0,00 | 11 | 007 | -1,25 | -1,59 | 12 | 009 | -7,01 | -7,01| | 1 | 007 | 1,56 | -0,86 | 2 | 007 | 2,33 | -0,47 | 3 | 006 | 1,95 | 0,00 | 4 | 009 | 3,69 | -1,45 | 5 | 009 | 9,28 | 0,00 | 6 | 004 | 0,66 | -0,71 | 7 | 006 | 6,29 | -1,32 | 8 | 004 | -0,95 | -2,08 | 9 | 004 | -2,31 | -3,71 | 10 | 011 | 2,73 | -2,87 | 11 | 008 | 11,95 | 0,00 | 12 | 001 | -1,24 | -1,24| | 1 | 005 | -0,97 | -1,94 | 2 | 014 | -0,59 | -0,99 | 3 | 009 | 4,29 | 0,00 | 4 | 012 | 10,57 | 0,00 | 5 | 010 | 1,89 | -3,91 | 6 | 003 | -0,01 | -0,76
//    RTKM|w - t|Min Williams A/D | 4|4|1||2 дня роста, 1 дня в op:sell p:10,00 s: 5,00| | 2010|024|014|  29,75|-1,13|-10,00|2011|019|018|  22,52|0,00| -6,61|2012|019|014|  34,14|0,00| -7,19|2013|015|006|  17,25|-1,67| -3,41 |  | 1 | 002 | 1,04 | 0,00 | 2 | 003 | 2,83 | -0,61 | 3 | 003 | -3,55 | -5,00 | 4 | 005 | 18,71 | 0,00 | 5 | 004 | 15,25 | 0,00 | 6 | 003 | -3,68 | -10,00 | 7 | 002 | 3,53 | 0,00 | 8 | 004 | 1,88 | 0,00 | 9 | 002 | 1,25 | 0,00 | 10 | 003 | -1,48 | -2,90 | 11 | 004 | -1,80 | -2,18 | 12 | 003 | -4,23 | -5,38| | 1 | 002 | 3,21 | 0,00 | 2 | 004 | 7,32 | 0,00 | 3 | 003 | -2,90 | -2,90 | 4 | 003 | 11,05 | 0,00 | 5 | 002 | 2,29 | 0,00 | 6 | 002 | -1,34 | -1,86 | 7 | 003 | -4,01 | -5,31 | 8 | 004 | 10,00 | 0,00 | 9 | 003 | 8,97 | 0,00 | 10 | 002 | -1,19 | -5,00 | 11 | 004 | -6,61 | -6,61 | 12 | 005 | -4,27 | -4,27| | 1 | 003 | 0,82 | 0,00 | 2 | 003 | 0,36 | -0,67 | 3 | 003 | -0,79 | -0,79 | 4 | 003 | 3,03 | 0,00 | 5 | 005 | 21,18 | 0,00 | 6 | 001 | -0,52 | -0,52 | 7 | 004 | 3,15 | 0,00 | 8 | 002 | -1,09 | -1,11 | 9 | 002 | -7,19 | -7,19 | 10 | 004 | 3,87 | -1,86 | 11 | 003 | 11,32 | 0,00| | 1 | 003 | 1,74 | 0,00 | 2 | 005 | -3,41 | -3,41 | 3 | 004 | 2,15 | 0,00 | 4 | 004 | 8,22 | 0,00 | 5 | 005 | 8,55 | -2,95
//    RTKM|w - t|Min Williams A/D | 5|2, 4|1||2 дня роста, 1 дня в op:sell p:12,00 s: 5,00| | 2010|025|028|  20,97|-10,34| -6,95|2011|027|019|  38,89|-0,61| -7,67|2012|025|019|  39,89|-0,29| -3,18|2013|019|008|  22,37|-4,70| -2,55 |  | 1 | 002 | -0,81 | -0,81 | 2 | 006 | -4,67 | -6,95 | 3 | 004 | -3,32 | -4,86 | 4 | 007 | 11,82 | 0,00 | 5 | 006 | 20,95 | 0,00 | 6 | 003 | -0,64 | -4,73 | 7 | 004 | -1,42 | -1,89 | 8 | 005 | -1,75 | -1,75 | 9 | 003 | 1,65 | 0,00 | 10 | 004 | -1,36 | -2,62 | 11 | 005 | -0,29 | -1,27 | 12 | 004 | 0,82 | -0,28| | 1 | 002 | -0,61 | -0,61 | 2 | 006 | 5,75 | 0,00 | 3 | 002 | -1,47 | -1,47 | 4 | 005 | 13,00 | -0,43 | 5 | 003 | -2,45 | -2,77 | 6 | 003 | 0,53 | -0,75 | 7 | 003 | -2,20 | -4,08 | 8 | 004 | 14,00 | 0,00 | 9 | 006 | 14,15 | -1,03 | 10 | 003 | 5,98 | 0,00 | 11 | 003 | -0,12 | -0,12 | 12 | 006 | -7,67 | -7,67| | 1 | 004 | 1,46 | -0,29 | 2 | 004 | 0,10 | -1,15 | 3 | 004 | 2,19 | 0,00 | 4 | 006 | 3,73 | 0,00 | 5 | 006 | 14,39 | 0,00 | 6 | 002 | 0,01 | 0,00 | 7 | 003 | 4,95 | -0,04 | 8 | 003 | -3,18 | -3,18 | 9 | 001 | 0,40 | 0,00 | 10 | 005 | 3,69 | -1,66 | 11 | 005 | 11,97 | 0,00 | 12 | 001 | 0,18 | 0,00| | 1 | 002 | -1,80 | -1,80 | 2 | 008 | -2,55 | -2,55 | 3 | 004 | 4,11 | -0,34 | 4 | 006 | 10,58 | 0,00 | 5 | 006 | 11,77 | 0,00 | 6 | 001 | 0,26 | 0,00
//    RTKM|w - t|Min Williams A/D | 6|2, 4|1||2 дня роста, 1 дня в op:sell p:10,00 s: 5,00| | 2010|024|025|  21,46|-13,14| -6,95|2011|025|017|  36,35|-4,40| -4,94|2012|022|018|  36,40|-0,29| -3,45|2013|017|008|  18,34|-3,99| -2,55 |  | 1 | 002 | -5,61 | -5,61 | 2 | 006 | -4,67 | -6,95 | 3 | 003 | -1,33 | -2,86 | 4 | 007 | 11,82 | 0,00 | 5 | 006 | 23,14 | 0,00 | 6 | 002 | 2,06 | -2,03 | 7 | 004 | -2,50 | -2,96 | 8 | 005 | -1,75 | -1,75 | 9 | 003 | 1,65 | 0,00 | 10 | 004 | -2,55 | -2,62 | 11 | 003 | 0,37 | 0,00 | 12 | 004 | 0,82 | -0,28| | 1 | 002 | -4,40 | -4,40 | 2 | 006 | 5,75 | 0,00 | 3 | 002 | -1,47 | -1,47 | 4 | 005 | 11,50 | -0,43 | 5 | 003 | -2,45 | -2,77 | 6 | 002 | 1,28 | 0,00 | 7 | 003 | -2,20 | -4,08 | 8 | 003 | 15,00 | 0,00 | 9 | 006 | 16,54 | 0,00 | 10 | 002 | 1,85 | 0,00 | 11 | 003 | -0,12 | -0,12 | 12 | 005 | -4,94 | -4,94| | 1 | 004 | 1,46 | -0,29 | 2 | 004 | 0,10 | -1,15 | 3 | 003 | 0,95 | -0,81 | 4 | 005 | 4,70 | 0,00 | 5 | 005 | 14,27 | 0,00 | 6 | 002 | 0,01 | 0,00 | 7 | 003 | 4,95 | -0,04 | 8 | 003 | -3,18 | -3,18 | 9 | 001 | -3,45 | -3,45 | 10 | 005 | 3,69 | -1,66 | 11 | 004 | 12,73 | 0,00 | 12 | 001 | 0,18 | 0,00| | 1 | 001 | -0,86 | -0,86 | 2 | 008 | -2,55 | -2,55 | 3 | 004 | 3,88 | -0,58 | 4 | 006 | 10,58 | 0,00 | 5 | 005 | 7,03 | -2,47 | 6 | 001 | 0,26 | 0,00
//    NVTK|w - t|Min Williams A/D | 8|5|2||2 дня роста, 1 дня в op:buy  p:11,00 s: 5,00| | 2010|011|002|  35,83|0,00| -5,00|2011|013|009|  20,08|-5,00|-10,00|2012|014|007|  24,08|-2,94| -5,00|2013|005|007|  13,09|-4,61| -5,86 |  | 2 | 001 | 5,96 | 0,00 | 3 | 002 | 10,90 | 0,00 | 4 | 001 | 5,50 | 0,00 | 5 | 002 | 3,21 | -5,00 | 6 | 001 | 2,62 | 0,00 | 8 | 002 | -0,00 | -1,90 | 9 | 001 | 3,10 | 0,00 | 10 | 001 | 1,26 | 0,00 | 11 | 002 | 3,27 | 0,00| | 1 | 002 | -2,51 | -5,00 | 2 | 001 | 5,06 | 0,00 | 3 | 001 | 5,65 | 0,00 | 4 | 002 | -6,87 | -6,87 | 5 | 003 | 9,06 | 0,00 | 6 | 002 | -6,12 | -6,12 | 7 | 001 | 8,58 | 0,00 | 8 | 003 | -8,73 | -10,00 | 9 | 001 | 11,00 | 0,00 | 11 | 003 | 3,20 | -2,74 | 12 | 003 | 1,78 | -5,00| | 1 | 002 | -0,50 | -0,50 | 2 | 002 | 1,88 | 0,00 | 3 | 002 | 0,15 | -2,76 | 4 | 001 | 0,53 | 0,00 | 5 | 003 | -3,37 | -5,00 | 6 | 002 | 7,06 | 0,00 | 7 | 003 | 10,75 | 0,00 | 9 | 002 | 2,76 | 0,00 | 10 | 002 | -2,71 | -2,71 | 11 | 002 | 7,54 | 0,00| | 1 | 001 | 3,46 | 0,00 | 2 | 002 | -2,20 | -2,20 | 3 | 004 | -0,00 | -3,29 | 4 | 003 | 1,81 | -5,86 | 5 | 001 | 11,00 | 0,00 | 6 | 001 | -0,97 | -0,97
//    RTKM|w - t|Max Williams A/D | 3|4, 5|2||2 дня падения, 1 дня в op:sell p: 9,00 s: 3,00| | 2010|022|019|  29,53|0,00| -8,02|2011|021|027|  23,84|-13,46|-15,00|2012|023|018|  21,86|-1,36| -9,79|2013|009|007|  13,37|0,00| -3,96 |  | 1 | 002 | 7,63 | 0,00 | 2 | 003 | 7,97 | 0,00 | 3 | 004 | 0,96 | -4,24 | 4 | 002 | 8,20 | 0,00 | 5 | 002 | 6,00 | 0,00 | 6 | 004 | 8,30 | 0,00 | 7 | 004 | 2,89 | -0,59 | 8 | 004 | -0,01 | -0,76 | 9 | 005 | -3,60 | -8,02 | 10 | 004 | -3,60 | -3,60 | 11 | 005 | -2,37 | -3,19 | 12 | 002 | -2,84 | -2,84| | 1 | 004 | -0,93 | -6,00 | 2 | 001 | 1,99 | 0,00 | 3 | 006 | -0,68 | -3,48 | 4 | 004 | 4,96 | -3,00 | 5 | 003 | 7,56 | -3,00 | 6 | 006 | -11,36 | -12,35 | 7 | 006 | -9,14 | -15,00 | 8 | 005 | 21,00 | 0,00 | 9 | 003 | 16,46 | 0,00 | 10 | 005 | -5,45 | -6,00 | 11 | 003 | 2,19 | 0,00 | 12 | 002 | -2,76 | -3,00| | 1 | 001 | -0,33 | -0,33 | 2 | 002 | 0,14 | 0,00 | 3 | 004 | 3,22 | -1,16 | 4 | 002 | 5,87 | 0,00 | 5 | 004 | 20,26 | 0,00 | 6 | 004 | -3,65 | -6,00 | 7 | 004 | 3,01 | -0,12 | 8 | 005 | -5,44 | -6,66 | 9 | 005 | -5,64 | -9,79 | 10 | 003 | 7,37 | 0,00 | 11 | 003 | 3,87 | 0,00 | 12 | 004 | -6,81 | -6,81| | 1 | 003 | 5,05 | 0,00 | 2 | 002 | -0,18 | -3,00 | 3 | 004 | 9,09 | 0,00 | 4 | 003 | 2,58 | 0,00 | 5 | 003 | -0,16 | -3,96 | 6 | 001 | -3,00 | -3,00
//    NVTK|w - t|Min Williams A/D | 7|2, 4|3||2 дня роста, 1 дня в op:buy  p: 9,00 s: 5,00| | 2010|011|005|  20,24|-0,60| -2,91|2011|015|011|  25,88|-7,78| -7,78|2012|015|009|  25,70|-1,57| -3,09|2013|009|007|  12,96|-5,84| -7,56 |  | 2 | 003 | 6,73 | -0,60 | 3 | 002 | 2,19 | 0,00 | 5 | 002 | 9,64 | 0,00 | 6 | 001 | -0,29 | -0,29 | 8 | 004 | -1,41 | -2,91 | 9 | 001 | 2,84 | 0,00 | 10 | 001 | 1,01 | 0,00 | 11 | 002 | -0,46 | -0,46| | 1 | 003 | -7,78 | -7,78 | 2 | 001 | 2,25 | 0,00 | 3 | 001 | 6,80 | 0,00 | 4 | 002 | -4,78 | -4,78 | 5 | 005 | 1,48 | -3,56 | 6 | 002 | -2,44 | -5,00 | 7 | 001 | -1,71 | -1,71 | 8 | 005 | 8,74 | 0,00 | 9 | 001 | 9,00 | 0,00 | 10 | 002 | 8,17 | 0,00 | 11 | 002 | 4,78 | -0,51 | 12 | 001 | 1,39 | 0,00| | 1 | 003 | -1,53 | -1,57 | 2 | 002 | 1,34 | 0,00 | 3 | 001 | 0,25 | 0,00 | 4 | 003 | 2,81 | -0,50 | 5 | 002 | -3,09 | -3,09 | 6 | 004 | 10,43 | 0,00 | 7 | 002 | 5,47 | 0,00 | 9 | 002 | 3,88 | 0,00 | 10 | 004 | 2,36 | 0,00 | 11 | 001 | 3,78 | 0,00| | 1 | 001 | 1,55 | 0,00 | 2 | 003 | -3,44 | -4,51 | 3 | 001 | 3,61 | 0,00 | 4 | 005 | -7,56 | -7,56 | 5 | 004 | 19,13 | 0,00 | 6 | 002 | -0,33 | -3,06
//    GAZP|w - t|Min Williams A/D | 3|2|3||2 дня роста, 1 дня в op:sell p:10,00 s: 5,00| | 2010|024|019|  21,24|0,00| -2,60|2011|025|023|  20,67|-4,81| -8,82|2012|030|020|  22,39|-2,64| -4,54|2013|018|010|  14,64|0,00| -9,95 |  | 1 | 002 | 2,12 | 0,00 | 2 | 003 | 4,15 | 0,00 | 3 | 005 | 0,12 | -0,48 | 4 | 003 | 4,80 | 0,00 | 5 | 005 | 6,17 | 0,00 | 6 | 005 | 9,49 | 0,00 | 7 | 002 | -2,60 | -2,60 | 8 | 006 | 0,24 | -1,18 | 9 | 005 | 0,46 | -0,43 | 10 | 003 | -1,58 | -1,58 | 11 | 002 | -1,16 | -1,16 | 12 | 002 | -0,98 | -1,60| | 1 | 004 | -3,90 | -3,90 | 2 | 005 | 5,24 | -0,91 | 3 | 001 | 0,48 | 0,00 | 4 | 003 | 1,43 | 0,00 | 5 | 006 | 6,59 | 0,00 | 6 | 005 | -8,82 | -8,82 | 7 | 004 | 2,76 | 0,00 | 8 | 005 | 15,91 | 0,00 | 9 | 004 | 6,49 | -1,84 | 10 | 002 | -5,68 | -5,68 | 11 | 005 | -1,95 | -2,29 | 12 | 004 | 2,12 | 0,00| | 1 | 001 | -0,46 | -0,46 | 2 | 003 | 0,79 | -2,18 | 3 | 004 | 4,61 | 0,00 | 4 | 007 | 3,36 | 0,00 | 5 | 005 | 7,87 | -2,11 | 6 | 002 | -1,34 | -1,55 | 7 | 004 | 1,75 | 0,00 | 8 | 004 | -2,92 | -4,54 | 9 | 004 | 2,85 | -0,55 | 10 | 007 | 5,86 | -1,36 | 11 | 006 | 1,98 | -0,97 | 12 | 003 | -1,95 | -1,95| | 1 | 002 | 0,44 | 0,00 | 2 | 007 | 4,38 | 0,00 | 3 | 005 | 10,99 | 0,00 | 4 | 007 | 2,14 | 0,00 | 5 | 005 | -9,95 | -9,95 | 6 | 002 | 6,64 | 0,00
//    RTKM|w - t|Min Williams A/D |22, 21, 20|2|1||4 дня падения, 1 дня в op:sell p:11,00 s: 3,00| | 2010|011|007|  20,92|0,00| -2,22|2011|010|004|  20,61|0,00| -5,74|2012|012|003|  21,37|-0,29| -3,00|2013|009|003|  16,03|0,00| -0,37 |  | 2 | 003 | 2,60 | 0,00 | 4 | 004 | 3,96 | 0,00 | 5 | 002 | 16,08 | 0,00 | 7 | 002 | -0,25 | -0,25 | 8 | 002 | -0,49 | -0,49 | 10 | 003 | -2,16 | -2,22 | 11 | 001 | 1,21 | 0,00 | 12 | 001 | -0,03 | -0,03| | 2 | 004 | 10,73 | 0,00 | 6 | 001 | 6,28 | 0,00 | 7 | 001 | 0,05 | 0,00 | 8 | 002 | 8,00 | 0,00 | 9 | 002 | -1,50 | -3,00 | 10 | 001 | 2,77 | 0,00 | 12 | 003 | -5,74 | -5,74| | 2 | 002 | 0,52 | 0,00 | 3 | 001 | -0,81 | -0,81 | 4 | 003 | 3,72 | 0,00 | 5 | 004 | 11,93 | 0,00 | 8 | 001 | -3,00 | -3,00 | 10 | 002 | 3,19 | 0,00 | 11 | 002 | 5,83 | 0,00| | 2 | 004 | 2,84 | 0,00 | 3 | 002 | 3,13 | 0,00 | 4 | 003 | 7,33 | 0,00 | 5 | 002 | 2,48 | -0,37 | 6 | 001 | 0,26 | 0,00
//    RTKM|w - t|Min Williams A/D | 6|3|1||3 дня падения, 1 дня в op:sell p:10,00 s: 4,00| | 2010|018|013|  22,59|-4,34| -4,19|2011|015|010|  20,55|-4,00| -4,00|2012|017|010|  45,12|-0,29| -5,86|2013|010|004|  23,64|-4,84| -2,80 |  | 1 | 001 | -0,34 | -0,34 | 2 | 004 | 1,38 | -4,00 | 3 | 002 | 1,02 | -1,01 | 4 | 004 | 10,54 | 0,00 | 5 | 002 | 20,00 | 0,00 | 6 | 002 | -2,18 | -4,00 | 7 | 003 | 2,15 | 0,00 | 8 | 004 | -2,90 | -2,90 | 10 | 003 | -4,19 | -4,19 | 11 | 003 | 0,29 | 0,00 | 12 | 003 | -3,17 | -3,17| | 1 | 001 | -4,00 | -4,00 | 2 | 004 | 11,37 | 0,00 | 3 | 001 | -4,00 | -4,00 | 4 | 002 | 2,34 | -4,00 | 5 | 002 | 0,04 | 0,00 | 6 | 001 | 5,70 | 0,00 | 7 | 002 | -3,46 | -4,00 | 8 | 002 | 6,00 | 0,00 | 9 | 003 | 8,33 | 0,00 | 10 | 001 | -4,00 | -4,00 | 11 | 002 | 3,33 | 0,00 | 12 | 004 | -1,11 | -1,11| | 1 | 002 | 2,92 | -0,29 | 2 | 004 | 2,36 | -0,34 | 3 | 002 | 1,30 | -0,87 | 4 | 002 | 3,55 | -0,35 | 5 | 005 | 17,86 | 0,00 | 6 | 001 | 2,16 | 0,00 | 7 | 002 | 4,16 | -0,59 | 8 | 003 | -5,86 | -5,86 | 10 | 003 | 3,00 | -2,90 | 11 | 003 | 13,68 | 0,00| | 1 | 001 | -2,80 | -2,80 | 2 | 004 | 0,02 | -2,05 | 3 | 003 | 4,28 | 0,00 | 4 | 002 | 8,08 | 0,00 | 5 | 004 | 14,06 | -0,24

    test("test intersections max / min <= 2")
    {
        val intersections = SimpleTrendWilliamsAdOutputParser.parse(
            Source.fromFile(".\\trend_williams_intersection_maxmin2.txt").getLines().mkString("\n"))
        for(intersection <- intersections)
        {
            check(intersection._1, intersection._2, intersection._3, sell, 20)
            check(intersection._1, intersection._2, intersection._3, buy, 20)
        }
    }

//    RTKM|w - t|Min Williams A/D | 3|1|1||3 дня роста, 1 дня в op:sell p:10,00 s: 5,00| | 2010|057|043|  35,26|-1,81| -4,45|2011|056|042|  30,20|0,00| -6,76|2012|051|043|  39,04|-0,69| -5,43|2013|035|022|  15,19|-3,59| -3,91 |  | 1 | 005 | 1,64 | 0,00 | 2 | 009 | 0,08 | -3,44 | 3 | 006 | -0,99 | -3,29 | 4 | 013 | 9,28 | 0,00 | 5 | 010 | 23,50 | 0,00 | 6 | 007 | 1,24 | -2,47 | 7 | 009 | -3,07 | -4,45 | 8 | 010 | -0,84 | -1,64 | 9 | 006 | 5,46 | 0,00 | 10 | 007 | -0,25 | -2,96 | 11 | 009 | 0,20 | -1,25 | 12 | 009 | -1,00 | -1,73| | 1 | 006 | 3,69 | 0,00 | 2 | 011 | 5,95 | 0,00 | 3 | 006 | 2,27 | 0,00 | 4 | 010 | 5,65 | 0,00 | 5 | 007 | 1,60 | -1,17 | 6 | 006 | 10,83 | -0,41 | 7 | 008 | 0,00 | -4,82 | 8 | 007 | 4,66 | 0,00 | 9 | 011 | 12,04 | -0,49 | 10 | 007 | -6,76 | -6,76 | 11 | 008 | -4,87 | -4,87 | 12 | 011 | -4,85 | -4,85| | 1 | 008 | 1,73 | -0,69 | 2 | 008 | 2,33 | -0,47 | 3 | 006 | 1,95 | 0,00 | 4 | 010 | 4,33 | -1,45 | 5 | 011 | 12,33 | 0,00 | 6 | 006 | -2,39 | -2,39 | 7 | 008 | 6,88 | -0,73 | 8 | 004 | -0,95 | -2,08 | 9 | 006 | -2,19 | -5,43 | 10 | 013 | 6,24 | 0,00 | 11 | 011 | 11,71 | 0,00 | 12 | 003 | -2,93 | -2,93| | 1 | 007 | -0,99 | -1,97 | 2 | 014 | -2,59 | -2,59 | 3 | 010 | 5,19 | 0,00 | 4 | 012 | 10,57 | 0,00 | 5 | 010 | 1,89 | -3,91 | 6 | 004 | 1,13 | 0,00
//    RTKM|w - t|Min Williams A/D | 3|1|1||2 дня роста, 1 дня в op:sell p:10,00 s: 5,00| | 2010|057|042|  35,98|-1,81| -4,45|2011|056|042|  30,20|0,00| -6,76|2012|051|042|  39,59|-0,69| -5,43|2013|035|022|  15,19|-3,59| -3,91 |  | 1 | 005 | 1,64 | 0,00 | 2 | 009 | 0,08 | -3,44 | 3 | 006 | -0,99 | -3,29 | 4 | 013 | 9,28 | 0,00 | 5 | 010 | 23,50 | 0,00 | 6 | 006 | 1,96 | -1,74 | 7 | 009 | -3,07 | -4,45 | 8 | 010 | -0,84 | -1,64 | 9 | 006 | 5,46 | 0,00 | 10 | 007 | -0,25 | -2,96 | 11 | 009 | 0,20 | -1,25 | 12 | 009 | -1,00 | -1,73| | 1 | 006 | 3,69 | 0,00 | 2 | 011 | 5,95 | 0,00 | 3 | 006 | 2,27 | 0,00 | 4 | 010 | 5,65 | 0,00 | 5 | 007 | 1,60 | -1,17 | 6 | 006 | 10,83 | -0,41 | 7 | 008 | 0,00 | -4,82 | 8 | 007 | 4,66 | 0,00 | 9 | 011 | 12,04 | -0,49 | 10 | 007 | -6,76 | -6,76 | 11 | 008 | -4,87 | -4,87 | 12 | 011 | -4,85 | -4,85| | 1 | 008 | 1,73 | -0,69 | 2 | 008 | 2,33 | -0,47 | 3 | 006 | 1,95 | 0,00 | 4 | 010 | 4,33 | -1,45 | 5 | 011 | 12,33 | 0,00 | 6 | 006 | -2,39 | -2,39 | 7 | 008 | 6,88 | -0,73 | 8 | 004 | -0,95 | -2,08 | 9 | 006 | -2,19 | -5,43 | 10 | 013 | 6,24 | 0,00 | 11 | 010 | 12,27 | 0,00 | 12 | 003 | -2,93 | -2,93| | 1 | 007 | -0,99 | -1,97 | 2 | 014 | -2,59 | -2,59 | 3 | 010 | 5,19 | 0,00 | 4 | 012 | 10,57 | 0,00 | 5 | 010 | 1,89 | -3,91 | 6 | 004 | 1,13 | 0,00
    test("test intersections 2 < max / min <= 5")
    {
        val intersections = SimpleTrendWilliamsAdOutputParser.parse(
            Source.fromFile(".\\trend_williams_intersection_maxmin2to5.txt").getLines().mkString("\n"))
        for(intersection <- intersections)
        {
            check(intersection._1, intersection._2, intersection._3, sell, 30)
            check(intersection._1, intersection._2, intersection._3, buy, 30)
        }
    }

//    RTKM|w - t|Min Williams A/D | 3|1|1||4 дня роста, 1 дня в op:sell p:10,00 s: 5,00| | 2010|057|043|  35,26|-1,81| -4,45|2011|056|042|  30,20|0,00| -6,76|2012|052|043|  40,19|-0,69| -5,43|2013|035|022|  15,19|-3,59| -3,91 |  | 1 | 005 | 1,64 | 0,00 | 2 | 009 | 0,08 | -3,44 | 3 | 006 | -0,99 | -3,29 | 4 | 013 | 9,28 | 0,00 | 5 | 010 | 23,50 | 0,00 | 6 | 007 | 1,24 | -2,47 | 7 | 009 | -3,07 | -4,45 | 8 | 010 | -0,84 | -1,64 | 9 | 006 | 5,46 | 0,00 | 10 | 007 | -0,25 | -2,96 | 11 | 009 | 0,20 | -1,25 | 12 | 009 | -1,00 | -1,73| | 1 | 006 | 3,69 | 0,00 | 2 | 011 | 5,95 | 0,00 | 3 | 006 | 2,27 | 0,00 | 4 | 010 | 5,65 | 0,00 | 5 | 007 | 1,60 | -1,17 | 6 | 006 | 10,83 | -0,41 | 7 | 008 | 0,00 | -4,82 | 8 | 007 | 4,66 | 0,00 | 9 | 011 | 12,04 | -0,49 | 10 | 007 | -6,76 | -6,76 | 11 | 008 | -4,87 | -4,87 | 12 | 011 | -4,85 | -4,85| | 1 | 008 | 1,73 | -0,69 | 2 | 008 | 2,33 | -0,47 | 3 | 006 | 1,95 | 0,00 | 4 | 010 | 4,33 | -1,45 | 5 | 012 | 13,48 | 0,00 | 6 | 006 | -2,39 | -2,39 | 7 | 008 | 6,88 | -0,73 | 8 | 004 | -0,95 | -2,08 | 9 | 006 | -2,19 | -5,43 | 10 | 013 | 6,24 | 0,00 | 11 | 011 | 11,71 | 0,00 | 12 | 003 | -2,93 | -2,93| | 1 | 007 | -0,99 | -1,97 | 2 | 014 | -2,59 | -2,59 | 3 | 010 | 5,19 | 0,00 | 4 | 012 | 10,57 | 0,00 | 5 | 010 | 1,89 | -3,91 | 6 | 004 | 1,13 | 0,00
//    RTKM|w - t|Min Williams A/D | 3|1|1||5 дня падения, 1 дня в op:sell p:12,00 s: 5,00| | 2010|050|038|  31,72|-0,72| -4,45|2011|052|036|  32,89|0,00| -6,76|2012|050|039|  44,14|-0,69| -5,43|2013|032|019|  18,20|-1,98| -3,91 |  | 1 | 005 | 1,64 | 0,00 | 2 | 007 | 1,83 | -2,36 | 3 | 006 | -0,99 | -3,29 | 4 | 009 | 4,05 | 0,00 | 5 | 008 | 25,10 | 0,00 | 6 | 007 | 1,24 | -2,47 | 7 | 009 | -3,07 | -4,45 | 8 | 010 | -0,84 | -1,64 | 9 | 002 | 3,81 | 0,00 | 10 | 007 | -0,25 | -2,96 | 11 | 009 | 0,20 | -1,25 | 12 | 009 | -1,00 | -1,73| | 1 | 006 | 3,69 | 0,00 | 2 | 010 | 10,95 | 0,00 | 3 | 006 | 2,27 | 0,00 | 4 | 006 | -1,74 | -1,85 | 5 | 006 | 4,38 | 0,00 | 6 | 006 | 10,83 | -0,41 | 7 | 008 | 0,00 | -4,82 | 8 | 006 | 0,32 | 0,00 | 9 | 010 | 12,37 | -0,49 | 10 | 007 | -6,76 | -6,76 | 11 | 007 | 0,13 | -1,59 | 12 | 010 | -3,55 | -3,55| | 1 | 005 | 2,26 | -0,69 | 2 | 008 | 2,33 | -0,47 | 3 | 006 | 1,95 | 0,00 | 4 | 010 | 4,33 | -1,45 | 5 | 012 | 13,48 | 0,00 | 6 | 006 | -2,39 | -2,39 | 7 | 008 | 6,88 | -0,73 | 8 | 004 | -0,95 | -2,08 | 9 | 006 | -2,19 | -5,43 | 10 | 012 | 7,76 | 0,00 | 11 | 010 | 12,37 | 0,00 | 12 | 002 | -1,69 | -1,69| | 1 | 007 | -0,99 | -1,97 | 2 | 012 | 3,70 | -0,99 | 3 | 010 | 5,19 | 0,00 | 4 | 008 | 7,29 | 0,00 | 5 | 010 | 1,89 | -3,91 | 6 | 004 | 1,13 | 0,00
//    RTKM|w - t|Min Williams A/D | 3|3|1||5 дня падения, 1 дня в op:sell p:12,00 s: 5,00| | 2010|025|023|  33,11|0,00| -9,84|2011|027|022|  32,08|0,00|-10,00|2012|027|019|  35,61|-0,29| -8,56|2013|017|008|  20,19|-6,18| -5,60 |  | 1 | 002 | 1,49 | 0,00 | 2 | 004 | 4,11 | -1,27 | 3 | 003 | -1,19 | -3,21 | 4 | 005 | 10,13 | 0,00 | 5 | 004 | 32,99 | 0,00 | 6 | 003 | 2,79 | -5,70 | 7 | 006 | -8,80 | -9,84 | 8 | 004 | -1,30 | -1,30 | 9 | 001 | 2,76 | 0,00 | 10 | 005 | -2,95 | -4,09 | 11 | 006 | 0,60 | -0,92 | 12 | 005 | -7,53 | -7,53| | 1 | 003 | 2,77 | 0,00 | 2 | 005 | 6,37 | 0,00 | 3 | 003 | -1,97 | -2,14 | 4 | 004 | 1,69 | -4,66 | 5 | 003 | 1,89 | 0,00 | 6 | 004 | 3,91 | -0,91 | 7 | 003 | -4,91 | -10,00 | 8 | 004 | 14,00 | 0,00 | 9 | 004 | 12,84 | -0,39 | 10 | 005 | -5,70 | -5,70 | 11 | 005 | -1,69 | -1,69 | 12 | 006 | 2,89 | 0,00| | 1 | 003 | 3,36 | -0,29 | 2 | 004 | 3,58 | 0,00 | 3 | 003 | 2,19 | -0,28 | 4 | 005 | 2,57 | -0,35 | 5 | 006 | 18,15 | 0,00 | 6 | 004 | -8,56 | -8,56 | 7 | 004 | 3,49 | -1,54 | 8 | 002 | 0,68 | -0,94 | 9 | 004 | -6,20 | -7,73 | 10 | 005 | 9,79 | 0,00 | 11 | 004 | 9,78 | 0,00 | 12 | 002 | -3,23 | -3,23| | 1 | 004 | -0,59 | -0,77 | 2 | 005 | -5,60 | -5,60 | 3 | 005 | 2,45 | 0,00 | 4 | 003 | 9,45 | 0,00 | 5 | 006 | 10,92 | -3,38 | 6 | 002 | 3,55 | 0,00
//    RTKM|w - t|Min Williams A/D | 4|1|1||5 дня падения, 1 дня в op:sell p:12,00 s: 5,00| | 2010|040|032|  31,56|-0,72| -2,96|2011|044|028|  36,80|0,00| -8,10|2012|040|031|  42,42|-0,29| -3,71|2013|030|017|  17,77|-1,95| -3,91 |  | 1 | 005 | 1,64 | 0,00 | 2 | 007 | 1,83 | -2,36 | 3 | 005 | -0,64 | -2,93 | 4 | 007 | 2,10 | -0,33 | 5 | 007 | 24,73 | 0,00 | 6 | 005 | 2,70 | -1,01 | 7 | 006 | -0,15 | -1,89 | 8 | 009 | -1,26 | -1,64 | 9 | 001 | 0,80 | 0,00 | 10 | 006 | -0,27 | -2,96 | 11 | 007 | 0,13 | -1,25 | 12 | 007 | -0,05 | -0,78| | 1 | 004 | 3,01 | 0,00 | 2 | 010 | 10,95 | 0,00 | 3 | 005 | 1,01 | 0,00 | 4 | 005 | 2,37 | 0,00 | 5 | 005 | 5,62 | 0,00 | 6 | 004 | 6,25 | -0,41 | 7 | 006 | -1,48 | -3,03 | 8 | 006 | 0,32 | 0,00 | 9 | 009 | 12,31 | -0,55 | 10 | 004 | 2,78 | 0,00 | 11 | 006 | 1,75 | -1,59 | 12 | 008 | -8,10 | -8,10| | 1 | 004 | 2,66 | -0,29 | 2 | 007 | 2,33 | -0,47 | 3 | 006 | 1,95 | 0,00 | 4 | 009 | 3,69 | -1,45 | 5 | 009 | 11,80 | 0,00 | 6 | 004 | 0,66 | -0,71 | 7 | 006 | 6,29 | -1,32 | 8 | 004 | -0,95 | -2,08 | 9 | 004 | -2,31 | -3,71 | 10 | 010 | 4,26 | -1,35 | 11 | 008 | 12,06 | 0,00| | 1 | 005 | -0,97 | -1,94 | 2 | 012 | 3,70 | -0,99 | 3 | 009 | 4,29 | 0,00 | 4 | 008 | 7,29 | 0,00 | 5 | 010 | 1,89 | -3,91 | 6 | 003 | 1,56 | 0,00
//    RTKM|w - t|Min Williams A/D | 5|2|1||5 дня падения, 1 дня в op:sell p:10,00 s: 5,00| | 2010|022|024|  31,94|-5,34| -4,86|2011|025|018|  33,58|-0,61| -7,67|2012|023|017|  41,19|-0,29| -3,18|2013|016|008|  19,61|-4,76| -2,62 |  | 1 | 002 | -0,81 | -0,81 | 2 | 005 | 0,33 | -1,95 | 3 | 004 | -3,32 | -4,86 | 4 | 005 | 8,34 | 0,00 | 5 | 004 | 31,17 | 0,00 | 6 | 003 | -0,64 | -4,73 | 7 | 004 | -1,42 | -1,89 | 8 | 005 | -1,75 | -1,75 | 9 | 001 | 0,87 | 0,00 | 10 | 004 | -1,36 | -2,62 | 11 | 005 | -0,29 | -1,27 | 12 | 004 | 0,82 | -0,28| | 1 | 002 | -0,61 | -0,61 | 2 | 005 | 10,75 | 0,00 | 3 | 002 | -1,47 | -1,47 | 4 | 003 | 6,68 | -0,43 | 5 | 003 | -2,45 | -2,77 | 6 | 003 | 0,53 | -0,75 | 7 | 003 | -2,20 | -4,08 | 8 | 004 | 10,00 | 0,00 | 9 | 006 | 14,15 | -1,03 | 10 | 003 | 5,98 | 0,00 | 11 | 003 | -0,12 | -0,12 | 12 | 006 | -7,67 | -7,67| | 1 | 002 | 2,26 | -0,29 | 2 | 004 | 0,10 | -1,15 | 3 | 004 | 2,19 | 0,00 | 4 | 006 | 3,73 | 0,00 | 5 | 006 | 14,39 | 0,00 | 6 | 002 | 0,01 | 0,00 | 7 | 003 | 4,95 | -0,04 | 8 | 003 | -3,18 | -3,18 | 9 | 001 | 0,40 | 0,00 | 10 | 004 | 4,38 | -0,97 | 11 | 005 | 11,97 | 0,00| | 1 | 002 | -1,80 | -1,80 | 2 | 007 | -2,62 | -2,62 | 3 | 004 | 4,11 | -0,34 | 4 | 004 | 7,89 | 0,00 | 5 | 006 | 11,77 | 0,00 | 6 | 001 | 0,26 | 0,00
//    RTKM|w - t|Min Williams A/D | 6|2|1||5 дня падения, 1 дня в op:sell p:10,00 s: 5,00| | 2010|021|021|  30,24|-8,14| -5,61|2011|024|015|  35,71|-4,40| -4,94|2012|021|016|  38,67|-0,29| -3,45|2013|014|008|  15,59|-4,05| -2,62 |  | 1 | 002 | -5,61 | -5,61 | 2 | 005 | 0,33 | -1,95 | 3 | 003 | -1,33 | -2,86 | 4 | 005 | 8,34 | 0,00 | 5 | 004 | 31,17 | 0,00 | 6 | 002 | 2,06 | -2,03 | 7 | 004 | -2,50 | -2,96 | 8 | 005 | -1,75 | -1,75 | 9 | 001 | 0,87 | 0,00 | 10 | 004 | -2,55 | -2,62 | 11 | 003 | 0,37 | 0,00 | 12 | 004 | 0,82 | -0,28| | 1 | 002 | -4,40 | -4,40 | 2 | 005 | 10,75 | 0,00 | 3 | 002 | -1,47 | -1,47 | 4 | 003 | 5,86 | -0,43 | 5 | 003 | -2,45 | -2,77 | 6 | 002 | 1,28 | 0,00 | 7 | 003 | -2,20 | -4,08 | 8 | 003 | 15,00 | 0,00 | 9 | 006 | 16,54 | 0,00 | 10 | 002 | 1,85 | 0,00 | 11 | 003 | -0,12 | -0,12 | 12 | 005 | -4,94 | -4,94| | 1 | 002 | 2,26 | -0,29 | 2 | 004 | 0,10 | -1,15 | 3 | 003 | 0,95 | -0,81 | 4 | 005 | 4,70 | 0,00 | 5 | 005 | 14,27 | 0,00 | 6 | 002 | 0,01 | 0,00 | 7 | 003 | 4,95 | -0,04 | 8 | 003 | -3,18 | -3,18 | 9 | 001 | -3,45 | -3,45 | 10 | 004 | 4,38 | -0,97 | 11 | 005 | 13,69 | 0,00| | 1 | 001 | -0,86 | -0,86 | 2 | 007 | -2,62 | -2,62 | 3 | 004 | 3,88 | -0,58 | 4 | 004 | 7,89 | 0,00 | 5 | 005 | 7,03 | -2,47 | 6 | 001 | 0,26 | 0,00
    test("test intersections 5 < max / min <= 10")
    {
        val intersections = SimpleTrendWilliamsAdOutputParser.parse(
            Source.fromFile(".\\trend_williams_intersection_maxmin5to10.txt").getLines().mkString("\n"))
        for(intersection <- intersections)
        {
            check(intersection._1, intersection._2, intersection._3, sell, 30)
            check(intersection._1, intersection._2, intersection._3, buy, 30)
        }
    }

    test("how many intersections williams and simpletrend?")
    {
        val williamses = (for(period <- 3 to 25; daysAfter <- 1 to 3) yield new WilliamsAdMax(period, 1, daysAfter)) ++
            (for(period <- 3 to 25; daysAfter <- 1 to 3) yield new WilliamsAdMin(period, 1, daysAfter))
        val simpleTrends = (for(checkDays <- 2 to 7) yield new PositiveTrendCandles(checkDays, 1)) ++
            (for(checkDays <- 2 to 7) yield new NegativeTrendCandles(checkDays, 1))
        val datas = Vector(gazp, gmkn, lkoh, nvtk, rosn, rtkm, sber)
        //посмотреть не только точные совпадения
        val intersectionPercent = (for(data <- datas; wl <- williamses; trend <- simpleTrends) yield
        {
            val wlDates = wl.filterInterestingPositions(data).map(_.positionDate)
            val trendDates = trend.filterInterestingPositions(data).map(_.positionDate)
            val maxLength = math.max(wlDates.length, trendDates.length).toDouble
            val minLength = math.min(wlDates.length, trendDates.length).toDouble
            if(maxLength / minLength > 10 || maxLength / minLength <= 5) null
            else
            {
                val common = wlDates.intersect(trendDates).length
                val desc = List(data.ticker, wlDates.length, trendDates.length, wl.desc, trend.desc).mkString("|")
                ((common.toDouble / minLength) * 100, desc)
            }
        }).filter(_ != null)
        intersectionPercent.sortBy(_._1).foreach{case (pct, desc) => println(pct.formatted("%5.2f") + " " + desc)}
    }

    def check(data: TradingData, williamsF: Int => WilliamsAdIdea, trendF: Int => LongTrendCandles, op: (Double, Double) => TradingOp, targetProfit: Double)
    {
        for(positionDays1 <- 1 to 5; positionDays2 <- 1 to 5)
        {
            val williams = williamsF(positionDays1)
            val trend = trendF(positionDays2)
            YearProfitStatistics.runIdea(Vector(1, 2, 3, 4, 5), Vector(8, 9, 10, 11, 12), targetProfit,
                (StrategyIdeaData(data, new SimpleTrendWithWilliamsIdea(williams, trend)), op))
        }
        for(positionDays <- 1 to 5)
        {
            YearProfitStatistics.runIdea(Vector(1, 2, 3, 4, 5), Vector(8, 9, 10, 11, 12), targetProfit,
                (StrategyIdeaData(data, new SimpleWilliamsWithoutTrendIdea(williamsF(positionDays), trendF(1))), op))
            YearProfitStatistics.runIdea(Vector(1, 2, 3, 4, 5), Vector(8, 9, 10, 11, 12), targetProfit,
                (StrategyIdeaData(data, new SimpleTrendWithoutWilliamsIdea(williamsF(1), trendF(positionDays))), op))
        }
    }
}
